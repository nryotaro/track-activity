<source>
  @type forward
  port 24224
</source>

#<match **.*>
#  @type stdout
#  include_time_key true
#  include_tag_key true
#  <format>
#    @type json
#  </format>
#</match>
<match analysis.*>
  @type bigquery_load
  auth_method json_key
  

  fetch_schema true
  <buffer>
    path /var/fluentd/bigquery.*.buffer
    flush_at_shutdown true
  </buffer>

  <format>
    @type json
  </format>
</match>
#<match analytics.*>
#  @type gcs
#  project "#{ENV['GCLOUD_PROJECT']}"
#  keyfile "#{ENV['GCLOUD_KEYFILE']}"
#  bucket "#{ENV['GCLOUD_BUCKET']}"
#  object_key_format %{path}%{time_slice}_%{index}.%{file_extension}
#  path logs/${tag}/%Y/%m/%d/
#  #path logs/
#
#  include_time_key true
#  include_tag_key true
#
#  # if you want to use ${tag} or %Y/%m/%d/ like syntax in path / object_key_format,
#  # need to specify tag for ${tag} and time for %Y/%m/%d in <buffer> argument.
#  <buffer tag,time>
#    @type file
#    path /var/log/fluent/gcs
#    #timekey 1h # 1 hour partition
#    timekey 2m # 1 hour partition
#    #timekey_wait 10m
#    timekey_wait 1m
#    timekey_use_utc true # use utc
#  </buffer>
#
#  <format>
#    @type json
#  </format>
#</match>
